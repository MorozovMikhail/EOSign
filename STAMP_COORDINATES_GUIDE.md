# Руководство по настройке координат полей штампа

## Описание

В проекте реализована возможность добавления динамических текстовых полей в штамп PDF. Пользователь может вводить данные на сайте, которые затем автоматически размещаются в нужных местах штампа.

## Поля штампа

На штампе размещаются следующие поля:
- **Название организации** - справа от "Название организации:"
- **Директор** - справа от "Директор:"
- **ИНН** - справа от "ИНН:"
- **Срок действия** - справа от "Срок действия:"

## Настройка координат

### Шаг 1: Анализ изображения штампа

1. Откройте файл `src/main/resources/stamp.png` в графическом редакторе
2. Определите размеры изображения (ширина x высота)
3. Найдите позиции, где должны быть размещены значения полей

### Шаг 2: Определение координат

Для каждого поля определите координаты (x, y) относительно изображения штампа:
- **x** - расстояние от левого края штампа до начала текста
- **y** - расстояние от нижнего края штампа до базовой линии текста

### Шаг 3: Обновление кода

Откройте файл `src/main/java/ru/gostsign/service/GostSignService.java` и найдите метод `addStampToPdf()`.

Обновите координаты в этом блоке:

```java
// Определяем координаты полей штампа (примерные, нужно скорректировать)
Map<String, StampField> stampFields = new HashMap<>();
stampFields.put("organizationName", new StampField("Название организации", 150, 50, 12, "#000000"));
stampFields.put("director", new StampField("Директор", 150, 35, 12, "#000000"));
stampFields.put("inn", new StampField("ИНН", 150, 20, 12, "#000000"));
stampFields.put("validityPeriod", new StampField("Срок действия", 150, 5, 12, "#000000"));
```

Замените значения координат на определенные вами.

### Шаг 4: Настройка нормализации

Координаты нормализуются относительно размера штампа в PDF:

```java
float x = stampX + field.getX() * stampWidth / 300; // Нормализуем координаты
float y = stampY + field.getY() * stampHeight / 100;
```

Если размеры вашего штампа сильно отличаются от предполагаемых, обновите делители (300 и 100) соответственно.

## Настройка стиля текста

### Размер шрифта

Измените размер шрифта в конструкторе `StampField`:

```java
new StampField("Название организации", 150, 50, 12, "#000000")
//                                                           ^ размер шрифта
```

### Цвет текста

Измените цвет в конструкторе `StampField`:

```java
new StampField("Название организации", 150, 50, 12, "#000000")
//                                                           ^ цвет (hex)
```

Также обновите цвет в методе `addDynamicTextFields()`:

```java
contentStream.setNonStrokingColor(Color.BLACK); // или другой цвет
```

## Тестирование

1. Запустите приложение
2. Перейдите в режим "Подписать документ"
3. Заполните поля штампа
4. Подпишите PDF документ
5. Проверьте, что текст размещен в правильных местах

## Примеры координат

### Для штампа 300x100 пикселей:
```java
stampFields.put("organizationName", new StampField("Название организации", 180, 70, 12, "#000000"));
stampFields.put("director", new StampField("Директор", 180, 55, 12, "#000000"));
stampFields.put("inn", new StampField("ИНН", 180, 40, 12, "#000000"));
stampFields.put("validityPeriod", new StampField("Срок действия", 180, 25, 12, "#000000"));
```

### Для штампа 400x150 пикселей:
```java
stampFields.put("organizationName", new StampField("Название организации", 220, 100, 14, "#000000"));
stampFields.put("director", new StampField("Директор", 220, 80, 14, "#000000"));
stampFields.put("inn", new StampField("ИНН", 220, 60, 14, "#000000"));
stampFields.put("validityPeriod", new StampField("Срок действия", 220, 40, 14, "#000000"));
```

## Устранение неполадок

### Текст не отображается
- Проверьте, что координаты находятся в пределах изображения штампа
- Убедитесь, что значения полей не пустые

### Текст отображается в неправильном месте
- Скорректируйте координаты x и y
- Проверьте нормализацию координат

### Текст слишком большой/маленький
- Измените размер шрифта в конструкторе `StampField`
- Обновите нормализацию координат

### Текст не читается
- Измените цвет текста
- Убедитесь, что цвет контрастирует с фоном штампа 